"use strict";!function(t,e,i){class s{constructor(e,a){this.$input=e;this.options=t.extend({},s.defaults,this.$input.data(),a);i.updateLocale(this.options.locale,{week:{dow:this.options.weekstart}});i.locale(this.options.locale);this._init();Foundation.registerPlugin(this,"Datepicker");Foundation.Keyboard.register("Datepicker",{ENTER:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}_init(){var e=Foundation.GetYoDigits(6,"datepicker");this.$input.attr({"data-toggle":e,"aria-controls":e,"data-is-focus":false,"data-yeti-box":e,"aria-haspopup":true,"aria-expanded":false});this.options.positionClass=this.getPositionClass();this.counter=4;this.usedPositions=[];this.$element=t('<div class="datepicker-container"></div>');this.$input.after(this.$element);this.$element.attr({id:e,"aria-hidden":"true","data-yeti-box":e,"data-resize":e,"aria-labelledby":this.$input[0].id||Foundation.GetYoDigits(6,"datepicker-input")});this.weekDaysHeader=this.buildWeekDaysheader();this._events();this.currentMonth=i().startOf("month");this.selectedDate=i()}buildWeekDaysheader(){var t="";var s=this.options.weekstart;for(var a=s;a<s+7;a++){var n=a;if(n>6)n=n-7;var o=i().day(n).format("ddd");t+=e.render(this.options.weekdayHeaderTemplate,{dayType:"weekday-header",day:o})}return t}buildCalendar(){this.$element.html("");var s=this.$input.val()==""?i():i(this.$input.val(),this.options.format,true);var a={month:this.currentMonth.format("MMMM YYYY"),weekdays:this.weekDaysHeader,days:this.buildCalendarDays(s)};var n=t(e.render(this.options.calendarTemplate,a));n.on("click",".months-nav > a",this.navigateMonths.bind(this)).on("click",".day",this.selectDay.bind(this));this.$element.append(n)}navigateMonths(e){if(t(e.currentTarget).hasClass("calendar-nav-next"))this.currentMonth.add(1,"month");if(t(e.currentTarget).hasClass("calendar-nav-previous"))this.currentMonth.subtract(1,"month");this.buildCalendar();return false}selectDay(e){this.$input.val(t(e.currentTarget).data("date"));this.selectedDate=i(t(e.currentTarget).data("date"),this.options.format);this.currentMonth=this.selectedDate.clone().startOf("month");this.close()}buildCalendarDays(t){var s="";var a=i(t.format("YYYY-MM-DD"));var n=i(this.currentMonth.format("YYYY-MM-DD"));n.startOf("month");var o=n.clone();o.endOf("month");n.startOf("week");o.endOf("week");for(n;!n.isAfter(o.format("YYYY-MM-DD"));n.add(1,"day")){var r=n.isSame(a.format("YYYY-MM-DD"),"day")?"current":n.isSame(this.currentMonth.format("YYYY-MM-DD"),"month")?n.isSame(i().format("YYYY-MM-DD"),"day")?"same-month today":"same-month":"other-month";s+=e.render(this.options.dayTemplate,{dayType:r,date:n.format(this.options.format),day:n.date()})}return s}getPositionClass(){var t=this.$input[0].className.match(/(top|left|right|bottom)/g);t=t?t[0]:"";var e=/float-(\S+)\s/.exec(this.$input[0].className);e=e?e[1]:"";var i=e?e+" "+t:t;return i}_reposition(t){this.usedPositions.push(t?t:"bottom");if(!t&&this.usedPositions.indexOf("top")<0){this.$element.addClass("top")}else if(t==="top"&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else if(t==="left"&&this.usedPositions.indexOf("right")<0){this.$element.removeClass(t).addClass("right")}else if(t==="right"&&this.usedPositions.indexOf("left")<0){this.$element.removeClass(t).addClass("left")}else if(!t&&this.usedPositions.indexOf("top")>-1&&this.usedPositions.indexOf("left")<0){this.$element.addClass("left")}else if(t==="top"&&this.usedPositions.indexOf("bottom")>-1&&this.usedPositions.indexOf("left")<0){this.$element.removeClass(t).addClass("left")}else if(t==="left"&&this.usedPositions.indexOf("right")>-1&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else if(t==="right"&&this.usedPositions.indexOf("left")>-1&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else{this.$element.removeClass(t)}this.classChanged=true;this.counter--}_setPosition(){if(this.$input.attr("aria-expanded")==="false"){return false}var t=this.getPositionClass(),e=Foundation.Box.GetDimensions(this.$element),i=Foundation.Box.GetDimensions(this.$input),s=this,a=t==="left"?"left":t==="right"?"left":"top",n=a==="top"?"height":"width",o=n==="height"?this.options.vOffset:this.options.hOffset;if(e.width>=e.windowDims.width||!this.counter&&!Foundation.Box.ImNotTouchingYou(this.$element)){this.$element.offset(Foundation.Box.GetOffsets(this.$element,this.$input,"center bottom",this.options.vOffset,this.options.hOffset,true)).css({width:e.windowDims.width-this.options.hOffset*2,height:"auto"});this.classChanged=true;return false}this.$element.offset(Foundation.Box.GetOffsets(this.$element,this.$input,t,this.options.vOffset,this.options.hOffset));while(!Foundation.Box.ImNotTouchingYou(this.$element,false,true)&&this.counter){this._reposition(t);this._setPosition()}}_events(){var t=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":this._setPosition.bind(this)});this.$input.add(this.$element).on("keydown.zf.datepicker",function(e){Foundation.Keyboard.handleKey(e,"Datepicker",{tab_forward:function(){t.close()},tab_backward:function(){t.close()},open:function(){if($target.is(t.$input)){t.open();t.$element.attr("tabindex",-1).focus();e.preventDefault()}},close:function(){t.close();t.$input.focus()}})})}_addBodyHandler(){var e=t(document.body).not(this.$element),i=this;e.off("click.zf.datepicker").on("click.zf.datepicker",function(t){if(i.$input.is(t.target)||i.$input.find(t.target).length){return}if(i.$element.find(t.target).length){return}i.close();e.off("click.zf.datepicker")})}open(){this.$element.trigger("closeme.zf.datepicker",this.$element.attr("id"));this.$input.attr({"aria-expanded":true});this._setPosition();this.$element.addClass("is-open").attr({"aria-hidden":false});this.buildCalendar();if(this.options.closeOnClick){this._addBodyHandler()}this.$element.trigger("show.zf.datepicker",[this.$element])}close(){if(!this.$element.hasClass("is-open")){return false}this.$element.removeClass("is-open").attr({"aria-hidden":true});this.$input.attr("aria-expanded",false);if(this.classChanged){var t=this.getPositionClass();if(t){this.$element.removeClass(t)}this.$element.addClass(this.options.positionClass).css({height:"",width:""});this.classChanged=false;this.counter=4;this.usedPositions.length=0}this.currentMonth=this.selectedDate.clone().startOf("month");this.$element.trigger("hide.zf.datepicker",[this.$element])}toggle(){if(this.$element.hasClass("is-open")){this.close()}else{this.open()}}destroy(){this.$element.off(".zf.trigger").hide();this.$input.off(".zf.datepicker");Foundation.unregisterPlugin(this)}}s.defaults={vOffset:0,hOffset:0,positionClass:"",closeOnClick:!0,format:"YYYY-MM-DD",locale:"en",weekstart:0,calendarTemplate:'<div class="foudation-calendar"><div class="calendar-header"><div class="months-nav"><a class="calendar-nav-previous"><i class="fa fa-chevron-left fi-arrow-left"></i></a><div>{{month}}</div><a class="calendar-nav-next"><i class="fa fa-chevron-right fi-arrow-right"></i></a></div><div class="weekdays row small-up-7 collapse">{{{weekdays}}}</div></div><div class="days row small-up-7 collapse">{{{days}}}</div></div>',weekdayHeaderTemplate:'<div class="column day {{dayType}}"><strong>{{day}}</strong></div>',dayTemplate:'<div class="column"><a class="day {{dayType}}" data-date="{{date}}">{{day}}</a></div>'},Foundation.plugin(s,"Datepicker")}(jQuery,Mustache,moment);