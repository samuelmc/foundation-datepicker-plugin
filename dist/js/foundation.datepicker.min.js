"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();!function(t,e,i){var a=function(){function a(e,i){return _classCallCheck(this,a),this.$element=e,this.$element.is('input[type="text"]')?(this.options=t.extend({},a.defaults,this.$element.data(),i),this._init(),Foundation.registerPlugin(this,"Datepicker"),void Foundation.Keyboard.register("Datepicker",{ENTER:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})):void console.warn('The datepicker can only be used on an <input> element with type="text".')}return _createClass(a,[{key:"_init",value:function(){var e=this.$element.attr("id")?this.$element.attr("id"):Foundation.GetYoDigits(6,"datepicker"),a=Foundation.GetYoDigits(6,"datapicker-dropdown");i.updateLocale(this.options.locale,{week:{dow:this.options.weekstart}}),i.locale(this.options.locale),this.$element.attr({id:e,"data-toggle":a}),this.$element.parent().is(".datepicker-wrapper")||this.$element.wrap(t('<div class="datepicker-wrapper">')),this.$dropdown=t('<div id="'+a+'" class="datepicker-dropdown" data-dropdown></div>'),this.$dropdown.attr({"data-v-offset":this.options.vOffset,"data-h-offset":0,"data-close-on-click":this.options.closeOnClick}),t.inArray(this.options.size,["tiny","small","large"])>-1&&this.$dropdown.addClass(this.options.size),this.$element.after(this.$dropdown),this.$dropdown.foundation(),this.$date=""==this.$element.val()?i().startOf("date"):i(this.$element.val(),this.options.format,!0),this.$viewDate=this.$date.clone(),this._events(),this.selectedDate=i()}},{key:"_buildCalendar",value:function(){var e=t('<div class="datepicker-calendar">'),a=t("<nav>"+this.$viewDate.format("MMMM YYYY")+"</nav>"),o=t('<a data-date-nav="month" data-method="subtract"><i class="fa fa-chevron-left"></i></a>'),s=t('<a data-date-nav="month" data-method="add"><i class="fa fa-chevron-right"></i></a>'),n=t('<div class="weekdays row small-up-7 collapse">'),d=t('<div class="days row small-up-7 collapse">'),r=i(this.$viewDate.format("YYYY-MM-DD")),l=r.clone();e.append(a),a.prepend(o).append(s),e.append(n);for(var h=this.options.weekstart;h<this.options.weekstart+7;h++){var c=h;c>6&&(c-=7);var p=i().day(c).format("ddd");n.append(t('<div class="column">'+p+"</div>"))}for(e.append(d),r.startOf("month"),r.startOf("week"),l.endOf("month"),l.endOf("week"),r;!r.isAfter(l.format("YYYY-MM-DD"));r.add(1,"day")){var m=r.isSame(this.$date.format("YYYY-MM-DD"),"day")?"current":r.isSame(this.$date.format("YYYY-MM-DD"),"month")?r.isSame(i().format("YYYY-MM-DD"),"day")?"same-month today":"same-month":"other-month";d.append(t('<div class="column"><a class="'+m+'" data-set-date="'+r.format("YYYY-MM-DD")+'">'+r.date()+"</a></div>"))}this.$dropdown.empty(),this.$dropdown.append(e),e.foundation(),this._calendarEvents()}},{key:"_calendarEvents",value:function(){this.$dropdown.find("a[data-date-nav]").off("click").on("click",this._navigateDate.bind(this)),this.$dropdown.find("a[data-set-date]").off("click").on("click",this._setDate.bind(this)),this.options.closeOnClick&&this._overrideBodyHandler()}},{key:"_navigateDate",value:function(e){var i=t(e.currentTarget).data();this.$viewDate[i.dateNav](1,i.method),this._buildCalendar()}},{key:"_setDate",value:function(e){var a=i(t(e.currentTarget).data("set-date"));this.$date.set({year:a.get("year"),month:a.get("month"),date:a.get("date")}),this.$element.val(this.$date.format(this.options.format)),this.$viewDate=this.$date.clone(),this.options.closeOnSelect&&!this.options.time?(this.$dropdown.trigger("close"),this.$element.focus()):this.options.time?this._buildCalendar():this._buildCalendar()}},{key:"buildTimePicker",value:function(){this.preventFalseBodyClick=!0,this.$dropdown.html("");var i=["hour","minute"];this.options.meridiem&&i.push("meridiem");var a=this.buildHours(),o=this.buildMinutes(),s=this.options.meridiem?this.buildMeridien():"",n={date:this.selectedDate.format("DD MMMM YYYY"),coll_count:i.length,timeparts:a+o+s},d=t(e.render(this.options.timePickerTemplate,n));d.on("click",".nav-datepicker",this.buildCalendar.bind(this)).on("click",".hour-up:not(.disabled)",this.addHour.bind(this)).on("click",".hour-down:not(.disabled)",this.subtractHour.bind(this)).on("click",".minute-up:not(.disabled)",this.addMinute.bind(this)).on("click",".minute-down:not(.disabled)",this.subtractMinute.bind(this)).on("click",".meridiem-up:not(.disabled)",this.addMeridiem.bind(this)).on("click",".meridiem-down:not(.disabled)",this.subtractMeridiem.bind(this)).on("click",".close-datepicker",this.close.bind(this)),this.$dropdown.append(d)}},{key:"buildHours",value:function(){var t=[];return t=this.options.meridiem?["11","10","09","08","07","06","05","04","03","02","01","12"]:["23","22","21","20","19","18","17","16","15","14","13","12","11","10","09","08","07","06","05","04","03","02","01","00"],this.buildTimePartSelector(t,"hour")}},{key:"buildMinutes",value:function(){for(var t=[],e=60-this.options.minuteInterval;e>=0;e-=this.options.minuteInterval)t.push(10>e?"0"+e:""+e);return this.buildTimePartSelector(t,"minute")}},{key:"buildMeridien",value:function(){return this.buildTimePartSelector(["PM","AM"],"meridiem")}},{key:"buildTimePartSelector",value:function(i,a){var o=this,s="";return t.each(i,function(t,i){s+=e.render(o.options.timeOptionTemplate,{option:i,timepart:a})}),e.render(this.options.timePartSelectorTemplate,{options:s,timepart:a})}},{key:"addHour",value:function(e){this.selectedDate.add(1,"hours"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".hour-down").removeClass("disabled");var a=this.options.meridiem?this.selectedDate.format("hh"):this.selectedDate.format("HH"),o=i.find("."+a+"-hour"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":first-child")&&t(e.target).addClass("disabled")}},{key:"subtractHour",value:function(e){this.selectedDate.subtract(1,"hours"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".hour-up").removeClass("disabled");var a=this.options.meridiem?this.selectedDate.format("hh"):this.selectedDate.format("HH"),o=i.find("."+a+"-hour"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":last-child")&&t(e.target).addClass("disabled")}},{key:"addMinute",value:function(e){this.selectedDate.add(this.options.minuteInterval,"minutes"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".minute-down").removeClass("disabled");var a=this.selectedDate.format("mm"),o=i.find("."+a+"-minute"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":first-child")&&t(e.target).addClass("disabled")}},{key:"subtractMinute",value:function(e){this.selectedDate.subtract(this.options.minuteInterval,"minutes"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".minute-up").removeClass("disabled");var a=this.selectedDate.format("mm"),o=i.find("."+a+"-minute"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":last-child")&&t(e.target).addClass("disabled")}},{key:"addMeridiem",value:function(e){this.selectedDate.add(12,"hours"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".meridiem-down").removeClass("disabled");var a=this.selectedDate.format("A"),o=i.find("."+a+"-meridiem"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":first-child")&&t(e.target).addClass("disabled")}},{key:"subtractMeridiem",value:function(e){this.selectedDate.subtract(12,"hours"),this.$element.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".meridiem-up").removeClass("disabled");var a=this.selectedDate.format("A"),o=i.find("."+a+"-meridiem"),s=Foundation.Box.GetDimensions(o),n=s.height+s.offset.top-(s.parentDims.height+s.parentDims.offset.top);o.parent().animate({bottom:n+"px"},"600","swing"),o.is(":last-child")&&t(e.target).addClass("disabled")}},{key:"_events",value:function(){var e=this;this.$dropdown.on("show.zf.datepicker",this._buildCalendar.bind(this)),this.$element.add(this.$dropdown).off("keydown.zf.dropdown").on("keydown.zf.datepicker",function(i){var a=t(this);Foundation.Keyboard.handleKey(i,"Datepicker",{tab_forward:function(){e.$dropdown.trigger("close")},tab_backward:function(){e.$dropdown.trigger("close")},open:function(){a.is(e.$element)&&"false"==e.$element.attr("aria-expanded")&&(e.$dropdown.trigger("open"),i.preventDefault())},close:function(){e.$dropdown.trigger("close"),e.$element.focus()}})}),this._triggers()}},{key:"_overrideBodyHandler",value:function(){var e=t(document.body).not(this.$dropdown),i=this;e.off("click.zf.dropdown").on("click.zf.datepicker",function(a){i.$element.is(a.target)||i.$element.find(a.target).length||!t(document).find(a.target).length||i.$dropdown.find(a.target).length||(i.$dropdown.trigger("close"),e.off("click.zf.datepicker"))})}},{key:"_triggers",value:function(){var t=this;this.$dropdown.on("show.zf.dropdown",function(e){t.$dropdown.trigger("show.zf.datepicker")})}},{key:"destroy",value:function(){this.$dropdown.remove(),this.$element.off(".zf.datepicker"),Foundation.unregisterPlugin(this)}}]),a}();a.defaults={vOffset:10,size:"",closeOnClick:!0,closeOnSelect:!0,format:"YYYY-MM-DD",locale:"en",weekstart:0,time:!1,meridiem:!1,minuteInterval:15,timePickerTemplate:'<div class="foundation-calendar"><div class="calendar-header"><a class="nav-datepicker">{{date}}</a></div><div class="timepicker row small-up-{{coll_count}} collapse">{{{timeparts}}}</div><a class="close-datepicker">Ok</a></div>',timePartSelectorTemplate:'<div class="column {{timepart}}"><a class="button primary expanded {{timepart}}-up"><i class="fa fa-chevron-up fi-arrow-up"></i></a><div class="timepart-options-container"><div class="options">{{{options}}}</div></div><a class="button primary expanded {{timepart}}-down disabled"><i class="fa fa-chevron-down fi-arrow-down"></i></a></div>',timeOptionTemplate:'<div class="time-option {{option}}-{{timepart}}">{{option}}</div>'},Foundation.plugin(a,"Datepicker")}(jQuery,Mustache,moment);