"use strict";!function(t,e,i){class s{constructor(e,i){this.$input=e;if(!this.$input.is('input[type="text"]')){console.warn('The datepicker can only be used on an <input> element with type="text".');return}this.options=t.extend({},s.defaults,this.$input.data(),i);this._init();Foundation.registerPlugin(this,"Datepicker");Foundation.Keyboard.register("Datepicker",{ENTER:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}_init(){var e=Foundation.GetYoDigits(6,"datepicker");i.updateLocale(this.options.locale,{week:{dow:this.options.weekstart}});i.locale(this.options.locale);this.$input.attr({"data-toggle":e,"aria-controls":e,"data-is-focus":false,"data-yeti-box":e,"aria-haspopup":true,"aria-expanded":false});this.options.positionClass=this.getPositionClass();this.counter=4;this.usedPositions=[];this.$element=t('<div class="datepicker-container"></div>');this.$element.attr({id:e,"aria-hidden":"true","data-yeti-box":e,"data-resize":e,"aria-labelledby":this.$input[0].id||Foundation.GetYoDigits(6,"datepicker-input")});this.$input.after(this.$element);this.weekDaysHeader=this.buildWeekDaysheader();this._events();this.currentMonth=i().startOf("month");this.selectedDate=i()}buildWeekDaysheader(){var t="";var s=this.options.weekstart;for(var a=s;a<s+7;a++){var n=a;if(n>6)n=n-7;var o=i().day(n).format("ddd");t+=e.render(this.options.weekdayHeaderTemplate,{dayType:"weekday-header",day:o})}return t}buildCalendar(){this.preventFalseBodyClick=true;this.$element.html("");var s=this.$input.val()==""?i():i(this.$input.val(),this.options.format,true);var a={month:this.currentMonth.format("MMMM YYYY"),weekdays:this.weekDaysHeader,days:this.buildCalendarDays(s)};var n=t(e.render(this.options.calendarTemplate,a));n.on("click",".months-nav > a",this.navigateMonths.bind(this)).on("click",".day",this.selectDay.bind(this));this.$element.append(n)}buildTimePicker(){this.preventFalseBodyClick=true;this.$element.html("");var i=["hour","minute"];if(this.options.meridiem)i.push("meridiem");var s=this.buildHours();var a=this.buildMinutes();var n=this.options.meridiem?this.buildMeridien():"";var o={date:this.selectedDate.format("DD MMMM YYYY"),coll_count:i.length,timeparts:s+a+n};var r=t(e.render(this.options.timePickerTemplate,o));r.on("click",".nav-datepicker",this.buildCalendar.bind(this)).on("click",".hour-up:not(.disabled)",this.addHour.bind(this)).on("click",".hour-down:not(.disabled)",this.subtractHour.bind(this)).on("click",".minute-up:not(.disabled)",this.addMinute.bind(this)).on("click",".minute-down:not(.disabled)",this.subtractMinute.bind(this)).on("click",".meridiem-up:not(.disabled)",this.addMeridiem.bind(this)).on("click",".meridiem-down:not(.disabled)",this.subtractMeridiem.bind(this));this.$element.append(r)}buildHours(){var t=[];if(this.options.meridiem)t=["11","10","09","08","07","06","05","04","03","02","01","12"];else t=["23","22","21","20","19","18","17","16","15","14","13","12","11","10","09","08","07","06","05","04","03","02","01","00"];return this.buildTimePartSelector(t,"hour")}buildMinutes(){var t=[];for(var e=60-this.options.minuteInterval;e>=0;e=e-this.options.minuteInterval){t.push(e<10?"0"+e:""+e)}return this.buildTimePartSelector(t,"minute")}buildMeridien(){return this.buildTimePartSelector(["PM","AM"],"meridiem")}buildTimePartSelector(i,s){var a=this;var n="";t.each(i,function(t,i){n+=e.render(a.options.timeOptionTemplate,{option:i,timepart:s})});return e.render(this.options.timePartSelectorTemplate,{options:n,timepart:s})}navigateMonths(e){if(t(e.currentTarget).hasClass("month-nav-next"))this.currentMonth.add(1,"month");if(t(e.currentTarget).hasClass("month-nav-previous"))this.currentMonth.subtract(1,"month");this.buildCalendar();return false}selectDay(e){this.$input.val(t(e.currentTarget).data("date"));this.selectedDate=i(t(e.currentTarget).data("date"),this.options.format);this.currentMonth=this.selectedDate.clone().startOf("month");if(this.options.time)this.buildTimePicker();else this.close()}addHour(e){this.selectedDate.add(1,"hours");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".hour-down").removeClass("disabled");var s=this.options.meridiem?this.selectedDate.format("hh"):this.selectedDate.format("HH");var a=i.find("."+s+"-hour");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":first-child")){t(e.target).addClass("disabled")}}subtractHour(e){this.selectedDate.subtract(1,"hours");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".hour-up").removeClass("disabled");var s=this.options.meridiem?this.selectedDate.format("hh"):this.selectedDate.format("HH");var a=i.find("."+s+"-hour");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":last-child")){t(e.target).addClass("disabled")}}addMinute(e){this.selectedDate.add(this.options.minuteInterval,"minutes");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".minute-down").removeClass("disabled");var s=this.selectedDate.format("mm");var a=i.find("."+s+"-minute");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":first-child")){t(e.target).addClass("disabled")}}subtractMinute(e){this.selectedDate.subtract(this.options.minuteInterval,"minutes");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".minute-up").removeClass("disabled");var s=this.selectedDate.format("mm");var a=i.find("."+s+"-minute");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":last-child")){t(e.target).addClass("disabled")}}addMeridiem(e){this.selectedDate.add(12,"hours");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".meridiem-down").removeClass("disabled");var s=this.selectedDate.format("A");var a=i.find("."+s+"-meridiem");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":first-child")){t(e.target).addClass("disabled")}}subtractMeridiem(e){this.selectedDate.subtract(12,"hours");this.$input.val(this.selectedDate.format(this.options.format));var i=t(e.target).parent();t(".meridiem-up").removeClass("disabled");var s=this.selectedDate.format("A");var a=i.find("."+s+"-meridiem");var n=Foundation.Box.GetDimensions(a);var o=n.height+n.offset.top-(n.parentDims.height+n.parentDims.offset.top);a.parent().animate({bottom:o+"px"},"600","swing");if(a.is(":last-child")){t(e.target).addClass("disabled")}}buildCalendarDays(t){var s="";var a=i(t.format("YYYY-MM-DD"));var n=i(this.currentMonth.format("YYYY-MM-DD"));n.startOf("month");var o=n.clone();o.endOf("month");n.startOf("week");o.endOf("week");for(n;!n.isAfter(o.format("YYYY-MM-DD"));n.add(1,"day")){var r=n.isSame(a.format("YYYY-MM-DD"),"day")?"current":n.isSame(this.currentMonth.format("YYYY-MM-DD"),"month")?n.isSame(i().format("YYYY-MM-DD"),"day")?"same-month today":"same-month":"other-month";s+=e.render(this.options.dayTemplate,{dayType:r,date:n.format(this.options.format),day:n.date()})}return s}getPositionClass(){var t=this.$input[0].className.match(/(top|left|right|bottom)/g);t=t?t[0]:"";var e=/float-(\S+)\s/.exec(this.$input[0].className);e=e?e[1]:"";var i=e?e+" "+t:t;return i}_reposition(t){this.usedPositions.push(t?t:"bottom");if(!t&&this.usedPositions.indexOf("top")<0){this.$element.addClass("top")}else if(t==="top"&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else if(t==="left"&&this.usedPositions.indexOf("right")<0){this.$element.removeClass(t).addClass("right")}else if(t==="right"&&this.usedPositions.indexOf("left")<0){this.$element.removeClass(t).addClass("left")}else if(!t&&this.usedPositions.indexOf("top")>-1&&this.usedPositions.indexOf("left")<0){this.$element.addClass("left")}else if(t==="top"&&this.usedPositions.indexOf("bottom")>-1&&this.usedPositions.indexOf("left")<0){this.$element.removeClass(t).addClass("left")}else if(t==="left"&&this.usedPositions.indexOf("right")>-1&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else if(t==="right"&&this.usedPositions.indexOf("left")>-1&&this.usedPositions.indexOf("bottom")<0){this.$element.removeClass(t)}else{this.$element.removeClass(t)}this.classChanged=true;this.counter--}_setPosition(){if(this.$input.attr("aria-expanded")==="false"){return false}var t=this.getPositionClass(),e=Foundation.Box.GetDimensions(this.$element),i=Foundation.Box.GetDimensions(this.$input),s=this,a=t==="left"?"left":t==="right"?"left":"top",n=a==="top"?"height":"width",o=n==="height"?this.options.vOffset:this.options.hOffset;if(e.width>=e.windowDims.width||!this.counter&&!Foundation.Box.ImNotTouchingYou(this.$element)){this.$element.offset(Foundation.Box.GetOffsets(this.$element,this.$input,"center bottom",this.options.vOffset,this.options.hOffset,true)).css({width:e.windowDims.width-this.options.hOffset*2,height:"auto"});this.classChanged=true;return false}this.$element.offset(Foundation.Box.GetOffsets(this.$element,this.$input,t,this.options.vOffset,this.options.hOffset));while(!Foundation.Box.ImNotTouchingYou(this.$element,false,true)&&this.counter){this._reposition(t);this._setPosition()}}_events(){var t=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":this._setPosition.bind(this)});this.$input.add(this.$element).on("keydown.zf.datepicker",function(e){Foundation.Keyboard.handleKey(e,"Datepicker",{tab_forward:function(){t.close()},tab_backward:function(){t.close()},open:function(){if($target.is(t.$input)){t.open();t.$element.attr("tabindex",-1).focus();e.preventDefault()}},close:function(){t.close();t.$input.focus()}})})}_addBodyHandler(){var e=t(document.body).not(this.$element),i=this;e.off("click.zf.datepicker").on("click.zf.datepicker",function(t){if(i.$input.is(t.target)||i.$input.find(t.target).length){return}if(i.$element.find(t.target).length){return}if(i.preventFalseBodyClick){i.preventFalseBodyClick=false;return}i.close();e.off("click.zf.datepicker")})}open(){this.$element.trigger("closeme.zf.datepicker",this.$element.attr("id"));this.$input.attr({"aria-expanded":true});this._setPosition();this.$element.addClass("is-open").attr({"aria-hidden":false});this.buildCalendar();this.preventFalseBodyClick=false;if(this.options.closeOnClick){this._addBodyHandler()}this.$element.trigger("show.zf.datepicker",[this.$element])}close(){if(!this.$element.hasClass("is-open")){return false}this.$element.removeClass("is-open").attr({"aria-hidden":true});this.$input.attr("aria-expanded",false);if(this.classChanged){var t=this.getPositionClass();if(t){this.$element.removeClass(t)}this.$element.addClass(this.options.positionClass).css({height:"",width:""});this.classChanged=false;this.counter=4;this.usedPositions.length=0}this.currentMonth=this.selectedDate.clone().startOf("month");this.$element.trigger("hide.zf.datepicker",[this.$element])}toggle(){if(this.$element.hasClass("is-open")){this.close()}else{this.open()}}destroy(){this.$element.off(".zf.trigger").hide();this.$input.off(".zf.datepicker");Foundation.unregisterPlugin(this)}}s.defaults={vOffset:0,hOffset:0,positionClass:"",closeOnClick:!0,format:"YYYY-MM-DD",locale:"en",weekstart:0,time:!1,meridiem:!1,minuteInterval:15,calendarTemplate:'<div class="foundation-calendar"><div class="calendar-header"><div class="months-nav"><a class="month-nav-previous"><i class="fa fa-chevron-left fi-arrow-left"></i></a><div>{{month}}</div><a class="month-nav-next"><i class="fa fa-chevron-right fi-arrow-right"></i></a></div><div class="weekdays row small-up-7 collapse">{{{weekdays}}}</div></div><div class="days row small-up-7 collapse">{{{days}}}</div></div>',weekdayHeaderTemplate:'<div class="column day {{dayType}}"><strong>{{day}}</strong></div>',dayTemplate:'<div class="column"><a class="day {{dayType}}" data-date="{{date}}">{{day}}</a></div>',timePickerTemplate:'<div class="foundation-calendar"><div class="calendar-header"><a class="nav-datepicker">{{date}}</a></div><div class="timepicker row small-up-{{coll_count}} collapse">{{{timeparts}}}</div><a class="close-datepicker">Ok</a></div>',timePartSelectorTemplate:'<div class="column {{timepart}}"><a class="button primary expanded {{timepart}}-up"><i class="fa fa-chevron-up fi-arrow-up"></i></a><div class="timepart-options-container"><div class="options">{{{options}}}</div></div><a class="button primary expanded {{timepart}}-down disabled"><i class="fa fa-chevron-down fi-arrow-down"></i></a></div>',timeOptionTemplate:'<div class="time-option {{option}}-{{timepart}}">{{option}}</div>'},Foundation.plugin(s,"Datepicker")}(jQuery,Mustache,moment);